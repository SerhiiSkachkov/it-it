(this.webpackJsonpwazom=this.webpackJsonpwazom||[]).push([[0],{34:function(e,t,a){e.exports=a(63)},43:function(e,t,a){},44:function(e,t,a){},46:function(e,t,a){},47:function(e,t,a){},48:function(e,t,a){},49:function(e,t,a){},50:function(e,t,a){},51:function(e,t,a){},52:function(e,t,a){},53:function(e,t,a){},57:function(e,t,a){},58:function(e,t,a){},59:function(e,t,a){},60:function(e,t,a){},61:function(e,t,a){},62:function(e,t,a){},63:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(19),s=a.n(c),i=a(6),o=a(12),l=a(33),m=a(13),u=a(4),d=a(21),f=a(22),p=a.n(f),E=(a(43),function(e){var t=e.children,a=e.onClick,n=e.className,c=e.disabled,s=Object(d.a)(e,["children","onClick","className","disabled"]),i=p()("btn",n),o=s.href?"a":"button";return r.a.createElement(o,Object.assign({className:i,disabled:c,onClick:function(e){if(!c)return a(e);e.preventDefault()}},s),t)}),g=a(1),b=function(){var e=localStorage.getItem("user");return e?{Authorization:"Token ".concat(e)}:{}},O="//smktesting.herokuapp.com/api",v=function(e){return{id:e.id,title:e.title,img:"".concat("//smktesting.herokuapp.com/static/").concat(e.img),text:e.text}},h=function(e){var t={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)};return fetch("".concat(O,"/register/"),t).then((function(e){return e.json()}))},j=function(e){var t={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)};return fetch("".concat(O,"/login/"),t).then((function(e){return e.json()}))},N=function(){localStorage.removeItem("user")},y=function(){return fetch("".concat(O,"/products/"),{method:"GET",headers:{"Content-Type":"application/json"}}).then((function(e){return e.json()})).then((function(e){return e.map((function(e){return v(e)}))}))},S=function(e){return fetch("".concat(O,"/reviews/").concat(e),{method:"GET",headers:{"Content-Type":"application/json"}}).then((function(e){return e.json()}))},T=function(e,t){console.log(t);var a={method:"POST",headers:Object(g.a)(Object(g.a)({},b()),{},{"Content-Type":"application/json"}),body:JSON.stringify(t)};return fetch("".concat(O,"/reviews/").concat(e),a).then((function(e){return e.json()}))},_=function(e){return{type:"SHOW_NOTIFICATION",payload:{notification:e}}},I=function(e){return{type:"HIDE_NOTIFICATION",payload:{id:e}}},C=(a(44),[{name:"Products",path:"/products"},{name:"Register",path:"/register"},{name:"Login",path:"/login"}]),R=function(){var e=Object(i.b)(),t=Object(i.c)((function(e){return e.login.isLogin}));return r.a.createElement("header",{className:"header"},r.a.createElement("div",{className:"header-wrapper"},r.a.createElement("div",{className:"logo"},"Logo"),r.a.createElement("nav",{className:"nav"},r.a.createElement("ul",{className:"nav-list"},t?r.a.createElement("li",null,r.a.createElement(E,{className:"btn-primary",onClick:function(){e((function(e){N(),e({type:"SET_LOGOUT"})}))}},"Logout")):C.map((function(e,t){return r.a.createElement("li",{key:e.path+t,className:"nav-item"},r.a.createElement(m.b,{to:e.path},e.name))}))))))},w=(a(46),function(){var e=Object(n.useMemo)((function(){return(new Date).getFullYear()}),[]);return r.a.createElement("div",{className:"footer"},e," \xa9 Light IT React-Redux Test")}),L=a(5),M=(a(47),function(e){var t=e.size,a=void 0!==t&&t,n=e.children;return r.a.createElement("div",{className:"container ".concat(a&&a," ")},n)}),k=(a(48),function(e){var t=e.title,a=void 0!==t&&t,n=e.children;return r.a.createElement("div",{className:"panel"},a&&r.a.createElement("h2",{className:"panel-title"}," ",a),r.a.createElement("div",{className:"panel-body"},n))}),G=a(14),x=(a(49),function(e){var t=e.message,a=e.type;return r.a.createElement("div",{className:"alert alert-".concat(a)},r.a.createElement("p",null,t))}),F=(a(50),function(e){var t=e.id,a=e.type,n=e.className,c=e.label,s=e.error,i=Object(d.a)(e,["id","type","className","label","error"]),o=p()("form-control",n,{error:s});return r.a.createElement("div",{className:"form-field"},c&&r.a.createElement("label",{className:"form-label",htmlFor:t},c),"textarea"!==a?r.a.createElement("input",Object.assign({name:t,id:t,type:a,className:o},i)):r.a.createElement("textarea",Object.assign({name:t,id:t,className:o},i)),s&&r.a.createElement("span",{className:"form-error"},s))}),D=function(e){var t={};return e.hasOwnProperty("username")&&(e.username.trim()?e.username.length<6&&(t.username="Username must contain at least 6 characters"):t.username="Username is required"),e.hasOwnProperty("password")&&(e.password.trim()?e.password.length<6&&(t.password="Password must contain at least 6 characters"):t.password="Password is required"),e.hasOwnProperty("comment")&&(e.comment.trim()||(t.comment="Comment so slow")),{error:t,isValid:0===Object.keys(t).length}},P=function(e){var t=e.initialValue,a=e.formData.fields,c=e.onHandleSubmit,s=e.submitBtnText,i=e.errorMessage,o=Object(n.useState)({}),l=Object(L.a)(o,2),m=l[0],u=l[1],d=Object(n.useState)(t),f=Object(L.a)(d,2),p=f[0],b=f[1],O=function(e){b(Object(g.a)(Object(g.a)({},p),{},Object(G.a)({},e.target.name,e.target.value)))},v=function(e){e.preventDefault();var t=D(p),a=t.error;if(!t.isValid)return u(a);u({}),c(p)};return r.a.createElement("div",{className:"form"},r.a.createElement("form",{onSubmit:v},a.map((function(e){var t=e.id,a=e.name,n=e.type,c=e.label;return r.a.createElement(F,{key:t,id:t,name:a,type:n,label:c,onChange:O,error:m[a]})})),i&&r.a.createElement(x,{type:"danger",message:i}),r.a.createElement(E,{className:"btn-primary",onClick:v},s)))},H={fields:[{label:"Username",name:"username",type:"text",id:"username"},{label:"Password",name:"password",type:"password",id:"password"}]},U=function(e){return{errorMessage:e.login.errorMessage,isLogin:e.login.isLogin}},z=function(){var e=Object(i.b)(),t=Object(u.f)(),a=Object(i.c)(U),c=a.isLogin,s=a.errorMessage,o=Object(n.useState)({username:"",password:""}),l=Object(L.a)(o,1)[0];Object(n.useEffect)((function(){c&&t.push("/products")}));return r.a.createElement("section",{className:"page  page-login page--center"},r.a.createElement(M,{size:"md"},r.a.createElement(k,{title:"Login"},r.a.createElement(P,{initialValue:l,onHandleSubmit:function(t){e(function(e){return function(t){t({type:"SET_LOGIN_PENDING"}),j(e).then((function(e){e.success?(t(_({type:"success",message:"Auto login saved"})),t({type:"SET_LOGIN_SUCCESS"}),localStorage.setItem("user",e.token)):t({type:"SET_LOGIN_FAILURE",payload:{errorMessage:e.message}})})).catch((function(e){t({type:"SET_LOGIN_ERROR",payload:{error:e}}),t(_({type:"danger",message:"Oops something happened"}))}))}}(t))},formData:H,submitBtnText:"Login",errorMessage:s}))))},A={fields:[{label:"Username",name:"username",type:"text",id:"username"},{label:"Password",name:"password",type:"password",id:"password"}]},V=function(e){return{isRegister:e.register.isRegister,errorMessage:e.register.errorMessage}},B=function(){var e=Object(i.b)(),t=Object(u.f)(),a=Object(i.c)(V),c=a.errorMessage,s=a.isRegister,o=Object(n.useState)({username:"",password:""}),l=Object(L.a)(o,1)[0];Object(n.useEffect)((function(){s&&t.push("/login")}));return r.a.createElement("section",{className:"page  page-register page--center"},r.a.createElement(M,{size:"md"},r.a.createElement(k,{title:"Register"},r.a.createElement(P,{initialValue:l,formData:A,onHandleSubmit:function(t){e(function(e){return function(t){t({type:"FETCH_REGISTER_PENDING"}),h(e).then((function(e){e.success?(t(_({type:"success",message:"Register successfully"})),t({type:"FETCH_REGISTER_SUCCESS"})):t({type:"FETCH_REGISTER_FAILURE",payload:{errorMessage:e.message}})})).catch((function(e){t({type:"FETCH_REGISTER_ERROR",payload:{error:e}}),t(_({type:"danger",message:"Oops something happened"}))}))}}(t))},submitBtnText:"Register",errorMessage:c}))))},J=(a(51),function(){return r.a.createElement("div",{className:"loader"},r.a.createElement("div",{className:"loader-img"},r.a.createElement("svg",{"aria-hidden":"true",focusable:"false","data-prefix":"fas","data-icon":"spinner",className:"svg-inline--fa fa-spinner fa-w-16",role:"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512"},r.a.createElement("path",{fill:"#78a5f7",d:"M304 48c0 26.51-21.49 48-48 48s-48-21.49-48-48 21.49-48 48-48 48 21.49 48 48zm-48 368c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.49-48-48-48zm208-208c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.49-48-48-48zM96 256c0-26.51-21.49-48-48-48S0 229.49 0 256s21.49 48 48 48 48-21.49 48-48zm12.922 99.078c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48c0-26.509-21.491-48-48-48zm294.156 0c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48c0-26.509-21.49-48-48-48zM108.922 60.922c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.491-48-48-48z"}))))}),q=(a(52),function(e){var t=e.card,a=t.title,n=t.text,c=t.img;return r.a.createElement("div",{className:"card"},r.a.createElement("div",{className:"card-img"},r.a.createElement("img",{src:c})),r.a.createElement("div",{className:"card-content"},r.a.createElement("div",{className:"card-title"},a),r.a.createElement("div",{className:"card-text"},n)))}),W=(a(53),function(e){var t=e.items,a=e.onClick,c=Object(n.useState)(-1),s=Object(L.a)(c,2),i=s[0],o=s[1],l=function(e){o(e),a(e)};return r.a.createElement("ul",{className:"list"},t.map((function(e){return r.a.createElement("li",{className:"list-item ".concat(i===e.id?"active":""),key:e.id,onClick:function(){return l(e.id)}},r.a.createElement("div",null,e.title))})))}),X=a(10),Y=a(11),K=(a(57),function(e){var t=e.rate;return r.a.createElement("div",{className:"rating"},function(e){for(var t=[],a=0;a<5;a++)a<=e?t.push(r.a.createElement(X.a,{key:a,className:"star active",icon:Y.e})):t.push(r.a.createElement(X.a,{key:a,className:"star",icon:Y.e}));return t}(t))}),Q=(a(58),function(e){var t=e.loading,a=e.comments,n=e.emptyMessage,c=void 0!==n&&n;return t?r.a.createElement(J,null):r.a.createElement(r.a.Fragment,null,a.length>0?r.a.createElement("div",{className:"comment-list"},a.map((function(e){var t=e.id,a=e.created_at,n=e.rate,c=e.text,s=e.created_by;return r.a.createElement("div",{className:"comment",key:t},r.a.createElement("div",{className:"comment-inner"},r.a.createElement("div",{className:"comment-header"},r.a.createElement("div",{className:"comment-author"},s.username),r.a.createElement("div",{className:"comment-date"},"Publish: ",new Date(a).toLocaleString())),r.a.createElement("div",{className:"comment-body"},r.a.createElement("div",{className:"comment-rate"},r.a.createElement(K,{rate:n})),r.a.createElement("div",{className:"comment-text"},c))))}))):r.a.createElement(x,{type:"info",message:c||"List is empty"}))}),Z=a(26),$=(a(59),function(e){var t=e.initialValue,a=e.formData.fields,c=e.onHandleSubmit,s=e.submitBtnText,i=e.errorMessage,o=e.maxRate,l=Object(n.useState)({}),m=Object(L.a)(l,2),u=m[0],d=m[1],f=Object(n.useState)(t),p=Object(L.a)(f,2),b=p[0],O=p[1],v=Object(n.useState)(null),h=Object(L.a)(v,2),j=h[0],N=h[1],y=function(e){O(Object(g.a)(Object(g.a)({},b),{},Object(G.a)({},e.target.name,e.target.value)))},S=function(e){e.preventDefault();var a=D(b),n=a.error;if(!a.isValid)return d(n);d({}),c(b),O(t)};return r.a.createElement("div",{className:"comment-form"},r.a.createElement("form",{onSubmit:S},o&&r.a.createElement("div",{className:"form-field form-field--rating"},Object(Z.a)(Array(o)).map((function(e,t){var a=t+1;return r.a.createElement(F,{className:"form-control--rating",key:t,id:t,value:a,name:"rate",type:"radio",label:r.a.createElement(X.a,{icon:Y.e,className:"star ".concat(a<=(b.rate||j)?"active":""," "),onMouseEnter:function(){return N(a)},onMouseLeave:function(){return N(null)}}),onClick:y})}))),a.map((function(e){var t=e.id,a=e.name,n=e.type,c=e.label;return r.a.createElement(F,{key:t,id:t,name:a,type:n,value:b.comment,label:c,onChange:y,error:u[a]})})),i&&r.a.createElement(x,{type:"danger",message:i}),r.a.createElement(E,{className:"btn-primary",onClick:S},s)))}),ee=(a(60),function(e){var t=e.sidebar,a=e.content;return r.a.createElement("div",{className:"layout"},r.a.createElement("aside",{className:"sidebar"},t),r.a.createElement("div",{className:"content"},a))}),te={fields:[{name:"comment",type:"textarea",id:"comment"}]},ae={comment:"",rate:0},ne=function(){var e=Object(i.b)(),t=Object(i.c)((function(e){return e.login.isLogin})),a=Object(n.useState)(!1),c=Object(L.a)(a,2),s=c[0],o=c[1],l=Object(n.useState)(!1),m=Object(L.a)(l,2),u=m[0],d=m[1],f=Object(n.useState)([]),p=Object(L.a)(f,2),E=p[0],g=p[1],b=Object(n.useState)(),O=Object(L.a)(b,2),v=O[0],h=O[1],j=Object(n.useState)([]),N=Object(L.a)(j,2),I=N[0],C=N[1],R=Object(n.useState)(ae),w=Object(L.a)(R,1)[0];Object(n.useEffect)((function(){o(!0),y().then((function(e){return g(e)})).then((function(){return o(!1)})).catch((function(t){console.log("[err]",t),e(_({type:"danger",message:"Oops something happened"}))}))}),[]);return s?r.a.createElement(J,null):r.a.createElement("section",{className:"page  page-products"},r.a.createElement(M,null,r.a.createElement(ee,{sidebar:r.a.createElement(W,{items:E,onClick:function(t){h(E.find((function(e){return e.id===t}))),d(!0),S(t).then((function(e){C(e),d(!1)})).catch((function(t){console.log("[err]",t),e(_({type:"danger",message:"Oops something happened"}))}))}}),content:r.a.createElement(r.a.Fragment,null,v?r.a.createElement(r.a.Fragment,null,r.a.createElement(q,{card:v}),t?r.a.createElement(k,{title:"Comment"},r.a.createElement($,{maxRate:5,initialValue:w,onHandleSubmit:function(t){var a=v.id,n={text:t.comment,rate:t.rate};T(a,n).then((function(t){t.success&&e(_({type:"success",message:"Comment added"}))})).catch((function(t){console.log("[err]",t),e(_({type:"danger",message:"Oops something happened"}))}))},formData:te,submitBtnText:"Send"})):r.a.createElement(x,{type:"danger",message:"Comments can be left only by registered users"}),r.a.createElement(Q,{comments:I,loading:u})):r.a.createElement(x,{type:"info",message:"Choose a product"}))})))},re=(a(61),function(){var e=Object(i.b)(),t=Object(i.c)((function(e){return e.notification.notifications}));if(Object(n.useEffect)((function(){var a=setInterval((function(){t.length>0&&e(I(t[0]))}),6e3);return function(){return clearInterval(a)}}),[t,e]),!t.length)return null;return r.a.createElement("div",{className:"notification-container top-right"},t.map((function(t){return r.a.createElement("div",{key:t.id,className:"notification notification-".concat(t.type)},r.a.createElement("button",{className:"notification-close",onClick:function(){return a=t.id,void e(I(a));var a}},r.a.createElement(X.a,{icon:Y.f})),r.a.createElement("div",{className:"notification-image"},function(e){switch(e){case"success":return r.a.createElement(X.a,{icon:Y.a});case"warning":return r.a.createElement(X.a,{icon:Y.b});case"info":return r.a.createElement(X.a,{icon:Y.d});case"danger":return r.a.createElement(X.a,{icon:Y.c});default:return e}}(t.type)),r.a.createElement("div",null,r.a.createElement("p",{className:"notification-title"},t.type),r.a.createElement("p",{className:"notification-message"},t.message)))})))}),ce=function(){var e=Object(i.b)();return Object(n.useEffect)((function(){localStorage.getItem("user")&&e({type:"SET_LOGIN_SUCCESS"})})),r.a.createElement(m.a,null,r.a.createElement("div",{className:"app-wrapper"},r.a.createElement(re,null),r.a.createElement(R,null),r.a.createElement("main",{className:"main"},r.a.createElement(u.c,null,r.a.createElement(u.a,{path:"/login",component:z}),r.a.createElement(u.a,{path:"/register",component:B}),r.a.createElement(u.a,{path:"/products",component:ne}))),r.a.createElement(w,null)))},se={error:null,notifications:[]},ie=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:se,t=arguments.length>1?arguments[1]:void 0,a=t.payload,n=t.type;switch(n){case"SHOW_NOTIFICATION":return Object(g.a)(Object(g.a)({},e),{},{notifications:[].concat(Object(Z.a)(e.notifications),[Object(g.a)({id:Math.floor(262*Math.random()+1)},a.notification)])});case"HIDE_NOTIFICATION":return Object(g.a)(Object(g.a)({},e),{},{notifications:e.notifications.filter((function(e){return e.id!==a.id}))});default:return e}},oe=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{isRegister:!1,errorMessage:null,isPending:!1},t=arguments.length>1?arguments[1]:void 0,a=t.payload,n=t.type;switch(n){case"FETCH_REGISTER_PENDING":return Object(g.a)(Object(g.a)({},e),{},{errorMessage:null,pending:!0});case"FETCH_REGISTER_SUCCESS":return Object(g.a)(Object(g.a)({},e),{},{pending:!1,isRegister:!0});case"FETCH_REGISTER_FAILURE":return Object(g.a)(Object(g.a)({},e),{},{pending:!1,errorMessage:a.errorMessage});case"FETCH_REGISTER_ERROR":return Object(g.a)(Object(g.a)({},e),{},{pending:!1,error:a.error});default:return e}},le=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{pending:!1,isLogin:!1,errorMessage:null},t=arguments.length>1?arguments[1]:void 0,a=t.payload,n=t.type;switch(n){case"SET_LOGIN_PENDING":return Object(g.a)(Object(g.a)({},e),{},{pending:!0});case"SET_LOGIN_SUCCESS":return Object(g.a)(Object(g.a)({},e),{},{pending:!1,isLogin:!0,errorMessage:null});case"SET_LOGIN_FAILURE":return Object(g.a)(Object(g.a)({},e),{},{pending:!1,errorMessage:a.errorMessage});case"SET_LOGIN_ERROR":return Object(g.a)(Object(g.a)({},e),{},{pending:!1,error:a.error});case"SET_LOGOUT":return Object(g.a)(Object(g.a)({},e),{},{isLogin:!1});default:return e}},me=Object(o.c)({register:oe,login:le,notification:ie}),ue=(a(62),window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||o.d),de=Object(o.e)(me,ue(Object(o.a)(l.a)));s.a.render(r.a.createElement(i.a,{store:de},r.a.createElement(ce,null)),document.getElementById("root"))}},[[34,1,2]]]);
//# sourceMappingURL=main.06300f36.chunk.js.map